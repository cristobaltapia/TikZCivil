%Here are defined all kind of drawing, that are useful for the Structural Analysis.
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tikzcivil}[2014/04/13 StructuralAnalysis Package]
\RequirePackage{tikz}
\RequirePackage{xkeyval}

\usetikzlibrary{calc,arrows,shapes,positioning,shadows,trees,patterns,decorations.pathmorphing,decorations.markings}
\tikzset{
  stock/.style={draw=black,text width=10em,line width=0.1em,pattern = north east lines},
  empotrado/.style={draw=none,text width=10em,line width=0.1em,pattern = north east lines},
  columna/.style={color=black, line width=0.1em},
  resorte/.style={color=black, line width=0.1em},
  flecha/.style={thick,<->},
  damper/.style={thick,decoration={markings,
    mark connection node=dmp,
    mark=at position 0.5 with
    {
      \node (dmp) [thick,inner sep=0pt,transform shape,rotate=-90,minimum width=10pt,minimum height=3pt,draw=none] {};
      \draw [thick] ($(dmp.north east)+(2pt,0)$) -- (dmp.south east) -- (dmp.south west) -- ($(dmp.north west)+(2pt,0)$);
      \draw [thick] ($(dmp.north)+(0,-3pt)$) -- ($(dmp.north)+(0,3pt)$);
    }
  }, decorate},
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	MarcoDespl:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This command defines a
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\FrameDispl}[3]{%
  \coordinate (p1) at (#1) {};
  \coordinate (p2) at ([shift={(#3,10em)}]p1) {};
  \coordinate (p3) at ([shift={(10em,0em)}]p1) {};
  \coordinate (p4) at ([shift={({10em+#3},10em)}]p1) {};
  \coordinate (p121) at ([shift={({#3/7},3em)}]p1) {};
  \coordinate (p122) at ([shift={({#3*6/7},7em)}]p1) {};
  \coordinate (p341) at ([shift={({10em+#3/7},3em)}]p1) {};
  \coordinate (p342) at ([shift={({10em+#3*6/7},7em)}]p1) {};
  \draw[columna] plot [smooth, tension=0.8] coordinates{(p1) (p121) (p122) (p2)};
  \draw[columna] plot [smooth, tension=0.8] coordinates{(p3) (p341) (p342) (p4)};
  \coordinate (p5) at ([shift={({10em+#3},9em)}]p1) {};
    %\coordinate[stock] at (5em,10em) (#1) {};
  \filldraw[stock] (p2) rectangle (p5);
    %Definir coordenadas para los apoyos
  \coordinate (p5) at ([shift={(-1.5em,0em)}]p1) {};
  \coordinate (p6) at ([shift={(1.5em,-1em)}]p1) {};
  \coordinate (p7) at ([shift={(8.5em,0em)}]p1) {};
  \coordinate (p8) at ([shift={(11.5em,-1em)}]p1) {};
  \ifnum #2 = 1 {%
    \filldraw[empotrado] (p5) rectangle (p6);
  \filldraw[empotrado] (p7) rectangle (p8);};
  \fi

}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	TMD:
% Tuned Mass Damper
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This command defines a Tuned Mass Damper system with
% an elastic spring
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\TMD}[2]{%
  \coordinate (p1) at (#1) ;
  \coordinate (p2) at ([shift={(0em,3em)}]p1) {};
  \coordinate (p3) at ([shift={(0em,1.5em)}]p1) {};
  \coordinate (p4) at ([shift={({3.5em+#2},1.5em)}]p1) {};
    %Nodos para la masa
  \coordinate (p5) at ([shift={({3.5em+#2},2.5em)}]p1) {};
  \coordinate (p6) at ([shift={({6.5em+#2},1em)}]p1) {};
    %Nodos para las ruedas
  \coordinate (p7) at ([shift={({4.0em+#2},0.5em)}]p1) {};
  \coordinate (p8) at ([shift={({6.0em+#2},0.5em)}]p1) {};

  \draw[columna, line width=0.3em] (p1) -- (p2);
  \pgfmathsetlengthmacro{\separacion}{(0.35+#2/9)*1em}
  \draw[decoration={aspect=0.3, segment length=\separacion, amplitude=0.4em,coil},decorate] (p3) -- (p4);
  \filldraw[stock] (p5) rectangle (p6);
    %Dibujar las ruedas
  \draw (p7) circle (0.5em);
  \draw (p8) circle (0.5em);
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	TMD:
% Tuned Mass Damper with damping
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This command defines a Tuned Mass Damper system with
% a damper and an alastic spring.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\TMDAmor}[2]{%
  \coordinate (p1) at (#1) ;
  \coordinate (p2) at ([shift={(0em,3em)}]p1) {};
  \coordinate (p3) at ([shift={(0em,2.3em)}]p1) {};
  \coordinate (p4) at ([shift={({3.5em+#2em},2.3em)}]p1) {};
    %Coordenadas para el amortiguamiento
  \coordinate (p9) at ([shift={(0em,1.2em)}]p1) {};
  \coordinate (p10) at ([shift={({3.5em+#2em},1.2em)}]p1) {};
    %Nodos para la masa
  \coordinate (p5) at ([shift={({3.5em+#2em},2.5em)}]p1) {};
  \coordinate (p6) at ([shift={({6.5em+#2em},1em)}]p1) {};
    %Nodos para las ruedas
  \coordinate (p7) at ([shift={({4.0em+#2em},0.5em)}]p1) {};
  \coordinate (p8) at ([shift={({6.0em+#2em},0.5em)}]p1) {};

  \draw[columna, line width=0.3em] (p1) -- (p2);
  \draw[damper, line width=0.1em] (p9) -- (p10);
  \pgfmathsetlengthmacro{\separacion}{(0.35+#2/9)*1em}
  \draw[decoration={aspect=0.3, segment length=\separacion, amplitude=0.4em,coil},decorate] (p3) -- (p4);
  \filldraw[stock] (p5) rectangle (p6);
    %Dibujar las ruedas
  \draw (p7) circle (0.5em);
  \draw (p8) circle (0.5em);
}

\def\fam@data{initial} 
\define@key{fam}{key}[default]{% 
  \def\fam@data{#1}%
}
\endinput
